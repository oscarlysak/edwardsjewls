{% load static %}
<!DOCTYPE html>
<html data-wf-page="6640cc23752af1f209c1ba21" data-wf-site="6640cc23752af1f209c1ba18">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Edwards Jewellers{% endblock %}</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="{% static 'css/normalize.css' %}" rel="stylesheet" type="text/css">
  <link href="{% static 'css/webflow.css' %}" rel="stylesheet" type="text/css">
  <link href="{% static 'css/edwards-jewellers-site.webflow.css' %}" rel="stylesheet" type="text/css">
  <link href="{% static 'css/custom.css' %}" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">
    WebFont.load({ google: { families: ["Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic"] } });
  </script>
  <script type="text/javascript">
    !function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);
  </script>
  <link href="{% static 'images/favicon.ico' %}" rel="shortcut icon" type="image/x-icon">
  <link href="{% static 'images/webclip.png' %}" rel="apple-touch-icon">
</head>
<body class="body">
  <!-- Navbar -->
  <div id="w-node-_44f28119-be43-087c-640a-17fece7a54e1-09c1ba21" data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navigation-bar w-nav">
    <div class="w-layout-grid _12colg colmargin">
      <div id="w-node-bc06f031-c813-c88b-620a-46be54bdb964-09c1ba21" class="navsearch">
        <form action="{% url 'shop' %}" method="GET" class="search-form">
          <input type="text" name="q" placeholder="Search" class="search-input">
          <button type="submit" class="search-button">
            <img src="{% static 'images/search-icon.png' %}" alt="Search" class="search-icon">
          </button>
        </form> 
      </div>
      <div id="w-node-_3a3bb2fc-aa54-5a28-4889-2a1e6062541d-09c1ba21" class="logo-navmenu">
        <div class="navbarlogo">
          <a href="{% url 'index' %}" class="brand w-nav-brand">
            <img loading="lazy" src="{% static 'images/LOGO-FINAl.svg' %}" alt="logo" class="navimage">
          </a>
        </div>
        <nav role="navigation" class="navmenu w-nav-menu">
          <a href="{% url 'index' %}" class="navigationlink minor-third---bl-semi-bold w-nav-link">Home</a>
          <div class="navspacer">|</div>
          <a href="{% url 'shop' %}" class="navigationlink minor-third---bl-semi-bold w-nav-link">Shop</a>
          <div class="navspcer">|</div>
          <a href="#" class="navigationlink minor-third---bl-semi-bold w-nav-link">F.A.Q</a>
          <div class="navspacer">|</div>
          <a href="#" class="navigationlink minor-third---bl-semi-bold w-nav-link">Shipping &amp; Returns</a>
          <div class="navspacer">|</div>
          <a href="#" class="navigationlink minor-third---bl-semi-bold w-nav-link">Contact Us</a>
        </nav>
        <div class="menu-button-2 w-nav-button">
          <div class="w-icon-nav-menu"></div>
        </div>
      </div>
      <div id="w-node-f6c88100-ee27-6ea9-6cb0-abb8aa18a588-09c1ba21" class="navbasket">
        <div id="w-node-_2fca68f5-308a-15c1-f85d-835dd4e7d042-09c1ba21" class="w-commerce-commercecartwrapper cart">
            <a class="w-commerce-commercecartopenlink cart-button w-inline-block" role="button" aria-haspopup="dialog" aria-label="Open cart" data-node-type="commerce-cart-open-link" href="#">
                <svg class="w-commerce-commercecartopenlinkicon icon" width="17px" height="17px" viewbox="0 0 17 17">
                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <path d="M2.60592789,2 L0,2 L0,0 L4.39407211,0 L4.84288393,4 L16,4 L16,9.93844589 L3.76940945,12.3694378 L2.60592789,2 Z M15.5,17 C14.6715729,17 14,16.3284271 14,15.5 C14,14.6715729 14.6715729,14 15.5,14 C16.3284271,14 17,14.6715729 17,15.5 C17,16.3284271 16.3284271,17 15.5,17 Z M5.5,17 C4.67157288,17 4,16.3284271 4,15.5 C4,14.6715729 4.67157288,14 5.5,14 C6.32842712,14 7,14.6715729 7,15.5 C7,16.3284271 6.32842712,17 5.5,17 Z" fill="currentColor" fill-rule="nonzero"></path>
                    </g>
                </svg>
                <div class="basket-text minor-third---bl-semi-bold w-inline-block">Basket</div>
                <div class="w-commerce-commercecartopenlinkcount cart-quantity">0</div>
            </a>
            <div class="cart-dropdown">
                <div class="cart-header">
                    <h4>Your Cart</h4>
                    <a class="close-cart" href="#">✕</a>
                </div>
                <div class="cart-body">
                    <div id="cart-items">
                        <!-- Cart items will be inserted here -->
                    </div>
                    <p>Subtotal: £<span id="cart-subtotal">0.00</span></p>
                    <button class="apple-pay-button">Apple Pay</button>
                    <a href="{% url 'checkout' %}" class="checkout-button">Continue to Checkout</a>
                </div>
            </div>
        </div>
      </div>
    </div>
  </div>

  {% block content %}
  {% endblock %}

  <!-- Footer -->
  <section class="footersection">
    <div class="w-layout-grid _12colg colmargin">
      <div id="w-node-c4944bba-edce-64ba-c83a-0ac6b81eea83-09c1ba21" class="footercolumnlogo">
        <div class="w-layout-grid footer4col">
          <div id="w-node-_89259c5a-200b-be8f-bafc-5cab7f2decf2-09c1ba21" class="div-block-29">
            <img src="{% static 'images/Edwards-Jewellers-Logo-Small.png' %}" loading="lazy" alt="">
            <p class="smalbdesc minor-third---body">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementu</p>
          </div>
        </div>
      </div>
      <div id="w-node-_5bc85b0e-e2b8-adec-30c6-24a620326614-09c1ba21" class="footercolumn">
        <h2 class="col-1-footer-h2 minor-third---footer-h2">Shop</h2>
        <div class="w-layout-grid grid-6">
          <div id="w-node-_8e276762-cc9d-5b52-1e89-2ece2c8cce6b-09c1ba21" class="div-block-30">
            <a href="#" class="link-block-3 w-inline-block">
              <div class="col-footer-h3 minor-third---footer-h3">Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
          </div>
          <div id="w-node-_237f38b8-f595-f6f5-9d4a-8507ac086aee-09c1ba21" class="div-block-30">
            <a href="#" class="link-block-3 w-inline-block">
              <div class="col-footer-h3 minor-third---footer-h3">New</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
          </div>
        </div>
      </div>
      <div id="w-node-_7f18f688-af57-46d1-b291-184131a96fdb-09c1ba21" class="footercolumn">
        <div class="w-layout-grid footer4col">
          <div id="w-node-_7f18f688-af57-46d1-b291-184131a96fdd-09c1ba21" class="div-block-29"></div>
        </div>
        <h2 class="col-1-footer-h2 minor-third---footer-h2">Information</h2>
        <div class="w-layout-grid grid-6">
          <div id="w-node-_7f18f688-af57-46d1-b291-184131a96fe1-09c1ba21" class="div-block-30">
            <a href="#" class="link-block-3 w-inline-block">
              <div class="col-footer-h3 minor-third---footer-h3">Support</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
          </div>
          <div id="w-node-_7f18f688-af57-46d1-b291-184131a96ff4-09c1ba21" class="div-block-30">
            <a href="#" class="link-block-3 w-inline-block">
              <div class="col-footer-h3 minor-third---footer-h3">Legal</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
            <a href="#" class="link-block-3 w-inline-block">
              <div>Vintage</div>
            </a>
          </div>
        </div>
      </div>
      <div id="w-node-_3faaa724-3aaa-5585-28ec-2489624ddd68-09c1ba21" class="footercolumn">
        <div class="w-layout-grid footer4col">
          <div id="w-node-e435377e-6a7f-979a-efbc-1250f779c6b3-09c1ba21">
            <h2 id="w-node-_17ceed7d-aefd-c124-b1ad-a63414dfef13-09c1ba21" class="col-1-footer-h2 minor-third---footer-h2">Follow Us</h2>
            <h5 id="w-node-b653ebf0-4a4b-3d5b-163d-8a23e0cefec4-09c1ba21" class="col-footer-h3 minor-third---footer-h3">Mailing List</h5>
            <div id="w-node-e20c3947-c9e9-d940-c821-9e216a56a545-09c1ba21" class="mailinglistform w-form">
              <form id="email-form" name="email-form" data-name="Email Form" method="get" class="form" data-wf-page-id="6640cc23752af1f209c1ba21" data-wf-element-id="e20c3947-c9e9-d940-c821-9e216a56a546">
                <input class="formfieldmailing w-input" maxlength="256" name="name-2" data-name="Name 2" placeholder="Enter Email" type="email" id="name-2">
                <input type="submit" data-wait="Please wait..." class="submit-button w-button" value="Submit">
              </form>
              <div class="w-form-done">
                <div>Thank you! Your submission has been received!</div>
              </div>
              <div class="w-form-fail">
                <div>Oops! Something went wrong while submitting the form.</div>
              </div>
            </div>
            <h5 id="w-node-ff672e4c-5e99-daa0-de8c-563f7d555109-09c1ba21" class="col-footer-h3 minor-third---footer-h3">Social Media</h5>
            <ul role="list" class="w-list-unstyled">
              <li>Instagram<br></li>
              <li>Facebook<br></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="typeclasses">
    <div class="minor-third---h1-bold"></div>
    <div class="minor-third---h2-semi-bold"></div>
    <div class="minor-third---h3-semi-bold"></div>
    <div class="minor-third---bl-semi-bold"></div>
    <div class="minor-third---body-large"></div>
    <div class="minor-third---body"></div>
    <div class="minor-third---footer-h2"></div>
    <div class="minor-third---footer-h3"></div>
  </section>


  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6640cc23752af1f209c1ba18" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="{% static 'js/webflow.js' %}" type="text/javascript"></script>
  <script src="{% static 'js/custom.js' %}" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/webflow-commerce/1.0.0/webflow-commerce.js" type="text/javascript"></script>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function() {
        // Function to update the product list based on filters
        function updateProductList(categoryId, styleId, searchQuery) {
            $.ajax({
                url: '{% url "filter_products" %}',
                data: {
                    'category_id': categoryId,
                    'style_id': styleId,
                    'q': searchQuery
                },
                dataType: 'json',
                success: function(data) {
                    var productList = $('#w-node-_88aab53b-dc12-f4da-2b37-096a18c3b96c-78b4ab80');
                    productList.empty();
                    $.each(data.products, function(index, product) {
                        var imageUrl = product.image_url;
                        productList.append(
                            '<div id="w-node-_7592565a-0da9-5a97-80fb-d6bf7412e87c-78b4ab80" class="product-frame">' +
                            '<img src="' + imageUrl + '" loading="lazy" alt="' + product.name + '" class="product-image">' +
                            '<div class="productcontent">' +
                            '<div class="productinfo">' +
                            '<div class="productname minor-third---bl-semi-bold">' + product.name + '</div>' +
                            '<div class="productdescription minor-third---body">' + product.description + '</div>' +
                            '<div class="productprice minor-third---body-large">£' + product.price + '</div>' +
                            '</div>' +
                            '<div class="productbuttonrow">' +
                            '<a href="#" class="addtocart minor-third---body w-button">Buy</a>' +
                            '<div class="text-block-3">-</div>' +
                            '<a href="#" class="enquire minor-third---body w-button">Enquire</a>' +
                            '</div>' +
                            '</div>' +
                            '</div>'
                        );
                    });
                },
                error: function() {
                    alert('An error occurred while fetching the products.');
                }
            });
        }

        // Get URL parameters
        var urlParams = new URLSearchParams(window.location.search);
        var searchQuery = urlParams.get('q') || '';
        var categoryId = urlParams.get('category_id') || null;
        var styleId = urlParams.get('style_id') || null;

        // Initial product list update based on URL parameters
        if (searchQuery || categoryId || styleId) {
            updateProductList(categoryId, styleId, searchQuery);
        }

        // Event listeners for filters
        $('.filterlink, .link-block-4').on('click', function(event) {
            event.preventDefault();
            categoryId = $(this).data('category') || null;
            styleId = $(this).data('style') || null;
            updateProductList(categoryId, styleId, searchQuery);
        });

        // Event listener for search form submission
        $('.search-form').on('submit', function(event) {
            // Let the form submission proceed naturally
        });
    });
  </script>


  <script>
    $(document).ready(function() {
        // Function to update cart preview
        function updateCartPreview() {
            $.ajax({
                url: '{% url "cart_contents" %}',
                success: function(data) {
                    var cartItems = $('#cart-items');
                    var cartSubtotal = $('#cart-subtotal');
                    var cartQuantity = $('.cart-quantity');
                    cartItems.empty();
                    var totalQuantity = 0;
                    $.each(data.cart_items, function(index, item) {
                        totalQuantity += item.quantity;
                        cartItems.append(
                            '<div class="cart-item">' +
                                '<div class="cart-item-image-container">' +
                                    '<img src="' + item.product_image + '" alt="' + item.product_name + '" class="cart-item-image" />' +
                                '</div>' +
                                '<div class="cart-item-details">' +
                                    '<p>' + item.product_name + ' - £' + item.product_price + ' x ' + item.quantity + '</p>' +
                                '</div>' +
                            '</div>'
                        );
                    });
                    cartSubtotal.text(data.cart_subtotal.toFixed(2));
                    cartQuantity.text(totalQuantity);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.error('An error occurred while fetching the cart contents:', textStatus, errorThrown);
                }
            });
        }

        // Call updateCartPreview on page load
        updateCartPreview();

        // Handle Add to Cart
        $('.product-section').on('click', '.addtocart', function(event) {
            event.preventDefault();
            var productId = $(this).data('product-id');
            
            $.ajax({
                url: '{% url "add_product_to_cart" %}',
                type: 'POST',
                data: {
                    'product_id': productId,
                    'quantity': 1,
                    'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                success: function(data) {
                    console.log('Product added to cart successfully:', data);
                    updateCartPreview(); // Update cart without alert
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.error('An error occurred while adding the product to the cart:', textStatus, errorThrown, jqXHR.responseText);
                }
            });
        });

        // Handle product filter
        $('.filterlink, .link-block-4').on('click', function(event) {
            event.preventDefault();
            var categoryId = $(this).data('category') || null;
            var styleId = $(this).data('style') || null;
            
            $.ajax({
                url: '{% url "filter_products" %}',
                data: {
                    'category_id': categoryId,
                    'style_id': styleId
                },
                dataType: 'json',
                success: function(data) {
                    var productList = $('#w-node-_88aab53b-dc12-f4da-2b37-096a18c3b96c-78b4ab80');
                    productList.empty();
                    $.each(data.products, function(index, product) {
                        var imageUrl = product.image_url;
                        productList.append(
                            '<div id="w-node-_7592565a-0da9-5a97-80fb-d6bf7412e87c-78b4ab80" class="product-frame">' +
                            '<img src="' + imageUrl + '" loading="lazy" alt="' + product.name + '" class="product-image">' +
                            '<div class="productcontent">' +
                            '<div class="productinfo">' +
                            '<div class="productname minor-third---bl-semi-bold">' + product.name + '</div>' +
                            '<div class="productdescription minor-third---body">' + product.description + '</div>' +
                            '<div class="productprice minor-third---body-large">£' + product.price + '</div>' +
                            '</div>' +
                            '<div class="productbuttonrow">' +
                            '<a href="#" class="addtocart minor-third---body w-button" data-product-id="' + product.id + '">Buy</a>' +
                            '<div class="text-block-3">-</div>' +
                            '<a href="#" class="enquire minor-third---body w-button">Enquire</a>' +
                            '</div>' +
                            '</div>' +
                            '</div>'
                        );
                    });
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.error('An error occurred while fetching the products:', textStatus, errorThrown);
                }
            });
        });
    });
</script>

</body>
</html>



